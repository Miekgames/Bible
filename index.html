<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Bible App</title>

  <!-- GitHub Pages / Jekyll safe -->
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    body {
      margin: 0;
      font-family: system-ui, sans-serif;
      background: #f4f4f4;
      color: #111;
      transition: 0.3s;
    }

    body.dark {
      background: #121212;
      color: #eee;
    }

    header {
      background: #4b4bff;
      color: white;
      padding: 15px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    button, select, input {
      padding: 8px;
      font-size: 16px;
    }

    .controls {
      display: flex;
      gap: 10px;
      padding: 10px;
      flex-wrap: wrap;
    }

    #reader {
      max-width: 800px;
      margin: 20px auto;
      padding: 25px;
      font-size: 18px;
      line-height: 1.8;
      background: rgba(0,0,0,0.05);
      border-radius: 10px;
    }

    body.dark #reader {
      background: rgba(255,255,255,0.08);
    }

    .verse {
      margin-bottom: 10px;
    }

    .verse-number {
      font-size: 14px;
      opacity: 0.6;
      margin-right: 6px;
    }

    ul {
      list-style: none;
      padding: 10px;
      max-width: 800px;
      margin: auto;
    }

    li {
      cursor: pointer;
      padding: 6px;
    }

    li:hover {
      opacity: 0.7;
    }
  </style>
</head>

<body>

<header>
  <h1>üìñ Bible App</h1>
  <button id="themeToggle">üåô</button>
</header>

<div class="controls">
  <input id="searchInput" placeholder="Search (John 3 or John 3:16)" />
  <button id="searchBtn">Search</button>
</div>

<div class="controls">
  <select id="book"></select>
  <select id="chapter"></select>
  <button id="bookmarkBtn">‚≠ê Bookmark</button>
</div>

<div id="reader"></div>

<h2 style="text-align:center">‚≠ê Bookmarks</h2>
<ul id="bookmarks"></ul>

<script>
  const API = "https://bible-api.com/";

  const bookSelect = document.getElementById("book");
  const chapterSelect = document.getElementById("chapter");
  const reader = document.getElementById("reader");
  const bookmarksList = document.getElementById("bookmarks");
  const searchInput = document.getElementById("searchInput");

  const books = [
    "Genesis","Exodus","Leviticus","Numbers","Deuteronomy",
    "Joshua","Judges","Ruth","1 Samuel","2 Samuel",
    "Matthew","Mark","Luke","John","Acts",
    "Romans","1 Corinthians","2 Corinthians",
    "Galatians","Ephesians","Philippians","Colossians",
    "1 Thessalonians","2 Thessalonians","Revelation"
  ];

  // Load books
  books.forEach(b => {
    const opt = document.createElement("option");
    opt.value = b;
    opt.textContent = b;
    bookSelect.appendChild(opt);
  });

  // Load chapters (max 50, API handles overflow)
  for (let i = 1; i <= 50; i++) {
    const opt = document.createElement("option");
    opt.value = i;
    opt.textContent = `Chapter ${i}`;
    chapterSelect.appendChild(opt);
  }

  async function loadChapter(ref) {
    const res = await fetch(API + ref);
    const data = await res.json();

    reader.innerHTML = `<h2>${data.reference}</h2>`;

    if (!data.verses) {
      reader.innerHTML += "<p>Not found üò≠</p>";
      return;
    }

    data.verses.forEach(v => {
      const p = document.createElement("p");
      p.className = "verse";
      p.innerHTML = `<span class="verse-number">${v.verse}</span>${v.text}`;
      reader.appendChild(p);
    });
  }

  function updateChapter() {
    const ref = `${bookSelect.value} ${chapterSelect.value}`;
    loadChapter(ref);
  }

  bookSelect.onchange = updateChapter;
  chapterSelect.onchange = updateChapter;

  // Search
  document.getElementById("searchBtn").onclick = () => {
    loadChapter(searchInput.value);
  };

  // Dark mode (saved)
  const themeToggle = document.getElementById("themeToggle");
  if (localStorage.theme === "dark") document.body.classList.add("dark");

  themeToggle.onclick = () => {
    document.body.classList.toggle("dark");
    localStorage.theme = document.body.classList.contains("dark") ? "dark" : "";
  };

  // Bookmarks
  function loadBookmarks() {
    bookmarksList.innerHTML = "";
    const saved = JSON.parse(localStorage.bookmarks || "[]");
    saved.forEach(ref => {
      const li = document.createElement("li");
      li.textContent = ref;
      li.onclick = () => loadChapter(ref);
      bookmarksList.appendChild(li);
    });
  }

  document.getElementById("bookmarkBtn").onclick = () => {
    const ref = `${bookSelect.value} ${chapterSelect.value}`;
    const saved = JSON.parse(localStorage.bookmarks || "[]");
    if (!saved.includes(ref)) {
      saved.push(ref);
      localStorage.bookmarks = JSON.stringify(saved);
      loadBookmarks();
    }
  };

  loadBookmarks();

  // Default load
  bookSelect.value = "Genesis";
  chapterSelect.value = "1";
  loadChapter("Genesis 1");
</script>

</body>
</html>
